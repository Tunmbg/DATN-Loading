<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<body>
  <div th:fragment="content">
    <a class="close_side_menu" href="javascript:void(0);"></a>
    <div class="rbt-page-banner-wrapper">
      <!-- Start Banner BG Image  -->
      <div class="rbt-banner-image"></div>
      <!-- End Banner BG Image  -->
    </div>
    <!-- Start Card Style -->
    <div class="rbt-dashboard-area rbt-section-overlayping-top rbt-section-gapBottom">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <!-- Start Dashboard Top  -->
            <div th:replace="~{client/instructor/instructor-banner :: instructor-banner}"
              sec:authorize="hasAnyRole('ROLE_INSTRUCTOR', 'ROLE_ADMIN')"></div>
            <div th:replace="~{client/student/student-banner :: student-banner}"
              sec:authorize="hasRole('ROLE_STUDENT') and not hasAnyRole('ROLE_INSTRUCTOR', 'ROLE_ADMIN')"></div>
            <!-- End Dashboard Top  -->

            <div class="row g-5">
              <div class="col-lg-3">
                <!-- Start Dashboard Sidebar  -->
                <div th:replace="~{client/student/studentSidebar :: student-sidebar}"></div>
                <!-- End Dashboard Sidebar  -->
              </div>

              <div class="col-lg-9">
                <!-- Start Enrole Course  -->
                <div class="rbt-dashboard-content bg-color-white rbt-shadow-box">
                  <div class="content">
                    <div class="section-title">
                      <h4 class="rbt-title-style-3">Đánh giá</h4>
                    </div>
                    <div class="advance-tab-button mb--30">
                      <ul class="nav nav-tabs tab-button-style-2 justify-content-start" id="reviewTab-4" role="tablist">
                        <li role="presentation">
                          <a href="#" class="tab-button active" id="received-tab" data-bs-toggle="tab"
                            data-bs-target="#received" role="tab" aria-controls="received" aria-selected="true">
                            <span class="title">Được nhận</span>
                          </a>
                        </li>
                        <li role="presentation">
                          <a href="#" class="tab-button" id="given-tab" data-bs-toggle="tab" data-bs-target="#given"
                            role="tab" aria-controls="given" aria-selected="false">
                            <span class="title">Đã bình luận</span>
                          </a>
                        </li>
                      </ul>
                    </div>

                    <div class="tab-content">
                      <div class="tab-pane fade active show" id="received" role="tabpanel"
                        aria-labelledby="received-tab">
                        <div class="rbt-dashboard-table table-responsive mobile-table-750">
                          <table class="rbt-table table table-borderless">
                            <thead>
                              <tr>
                                <th>Học sinh</th>
                                <th>Ngày tạo</th>
                                <th>Nhận xét</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr th:each="review : ${reviews}">
                                <th th:text="${review.user.fullname}">Student Name</th>
                                <td th:text="${#dates.format(review.reviewedAt, 'MMMM dd, yyyy')}">Date</td>
                                <td>
                                  <span class="b3">
                                    Course:
                                    <a th:href="@{/course-details/{id}(id=${review.course.courseId})}"
                                      th:text="${review.course.title}">Course Title</a>
                                  </span>
                                  <div class="rbt-review">
                                    <div class="rating">
                                      <i class="fas fa-star"
                                        th:each="star : ${#numbers.sequence(1, review.rating)}"></i>
                                      <i class="far fa-star"
                                        th:each="star : ${#numbers.sequence(review.rating + 1, 5)}"></i>
                                    </div>
                                  </div>
                                  <p class="b2" th:text="${review.comment}">Feedback comment</p>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>

                      <div class="tab-pane fade" id="given" role="tabpanel" aria-labelledby="given-tab">
                        <div class="rbt-dashboard-table table-responsive mobile-table-750">
                          <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
                          <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
                          <table class="rbt-table table table-borderless">
                            <thead>
                              <tr>
                                <th>Tên khóa học</th>
                                <th>Nhận xét</th>
                                <th></th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr th:each="review : ${reviewsGive}">
                                <th>
                                  <a th:href="@{/course-details/{id}(id=${review.course.courseId})}"
                                    th:text="${review.course.title}">Course Title</a>
                                </th>
                                <td>
                                  <div class="rbt-review">
                                    <div class="rating">
                                      <i th:each="star : ${#numbers.sequence(1, 5)}"
                                        th:classappend="${star <= review.rating} ? 'fas fa-star' : 'far fa-star'"></i>
                                    </div>
                                    <span class="rating-count"
                                      th:text="'(' + ${review.course.reviews.size()} + ' Reviews)'"></span>
                                  </div>
                                  <p class="b3" th:text="${review.comment}">Comment</p>
                                </td>
                                <td>
                                  <div class="rbt-button-group">
                                    <a href="#" class="rbt-btn-link left-icon"
                                      th:onclick="'document.getElementById(\'editForm__' + ${review.reviewId} + '\').style.display = \'block\'; return false;'">
                                      <i class="feather-edit"></i> Edit
                                    </a>

                                    <form th:action="@{'/review/delete/' + ${review.reviewId}}" method="post"
                                      style="display: inline"
                                      onsubmit="return confirm('Bạn có chắc chắn muốn xóa review này?');">
                                      <button type="submit" class="rbt-btn-link left-icon btn btn-link"
                                        style="text-decoration: none">
                                        <i class="feather-trash-2"></i> Delete
                                      </button>
                                    </form>
                                  </div>

                                  <div th:id="'editForm__' + ${review.reviewId}"
                                    style="display: none; margin-top: 10px">
                                    <form th:action="@{/review/update}" method="post">
                                      <input type="hidden" name="reviewId" th:value="${review.reviewId}" />
                                      <div class="mb-2">
                                        <label for="rating">Rating (1-5)</label>
                                        <input type="number" class="form-control" name="rating" min="1" max="5"
                                          th:value="${review.rating}" required />
                                      </div>
                                      <div class="mb-2">
                                        <label for="comment">Comment</label>
                                        <textarea class="form-control" name="comment" rows="2"
                                          th:text="${review.comment}" required></textarea>
                                      </div>
                                      <button type="submit" class="btn btn-primary btn-sm"
                                        onclick="return confirm('Bạn có chắc chắn muốn lưu thay đổi không?');">
                                        Save
                                      </button>
                                      <button type="button" class="btn btn-secondary btn-sm"
                                        th:onclick="'document.getElementById(\'editForm__' + ${review.reviewId} + '\').style.display = \'none\';'">
                                        Cancel
                                      </button>
                                    </form>
                                  </div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- End Card Style -->
    <div class="rbt-separator-mid">
      <div class="container">
        <hr class="rbt-separator m-0" />
      </div>
    </div>
    <div class="rbt-progress-parent">
      <svg class="rbt-back-circle svg-inner" width="100%" height="100%" viewBox="-1 -1 102 102">
        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
      </svg>
    </div>
  </div>
</body>

</html>