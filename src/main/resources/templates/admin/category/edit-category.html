<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>
    <div id="main" th:fragment="content">
        <header class="mb-3">
            <a href="#" class="burger-btn d-block d-xl-none">
                <i class="bi bi-justify fs-3"></i>
            </a>
        </header>

        <div class="page-heading">
            <div class="page-title">
                <div class="row">
                    <div class="col-12 col-md-6 order-md-1 order-last">
                        <h3>Chỉnh sửa danh mục</h3>
                        <div th:if="${param.validError}" class="alert alert-danger">
                            <i class="bi bi-file-excel"></i> Tên danh mục không được để trống!
                        </div>
                    </div>
                    <div class="col-12 col-md-6 order-md-2 order-first">
                        <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a th:href="@{/admin/dashboard}">Tổng quan</a></li>
                                <li class="breadcrumb-item"><a th:href="@{/admin/categories}">Danh mục</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Sửa danh mục</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Basic Vertical form layout section start -->
            <section id="basic-vertical-layouts">
                <div class="row match-height">
                    <div class="col-md-6 col-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Thông tin danh mục</h4>
                            </div>
                            <div class="card-content">
                                <div class="card-body">
                                    <form th:action="@{'/admin/categories/update/' + ${category.categoryId}}"
                                        th:object="${category}" method="post" enctype="multipart/form-data"
                                        class="form form-vertical">
                                        <input type="hidden" name="_method" value="put" />
                                        <div class="form-body">
                                            <div class="row">
                                                <div class="col-12">
                                                    <div class="form-group">
                                                        <label for="first-name-vertical">Tên danh mục</label>
                                                        <input th:field="*{name}" type="text" class="form-control"
                                                            placeholder="Tên danh mục" />
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="form-group">
                                                        <label for="email-id-vertical">Danh mục cha</label>
                                                        <select th:field="*{parent.categoryId}" class="form-select"
                                                            id="basicSelect">
                                                            <option th:value="0">-- Chọn danh mục cha --</option>
                                                            <option th:each="item : ${parents}"
                                                                th:value="${item.categoryId}" th:text="${item.name}">
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="form-group">
                                                        <label for="contact-info-vertical">Ảnh danh mục</label>
                                                        <input type="file" id="imageInput" name="imageFile"
                                                            accept="image/*" class="form-control"
                                                            onchange="previewImage(event)">
                                                        <div class="mt-2">
                                                            <img id="imagePreview" src="#" alt="Preview"
                                                                style="width: 100%; max-height: 300px; object-fit: contain; display: none; border: 1px solid #ccc; padding: 4px;" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-12 d-flex justify-content-end">
                                                    <button type="submit"
                                                        class="btn btn-primary me-1 mb-1">Submit</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- // Basic Vertical form layout section end -->

        </div>
    </div>

    <th:block th:fragment="scripts">
        <script>
            function previewImage(event) {
                const input = event.target;
                const preview = document.getElementById('imagePreview');
                const file = input.files[0];

                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                } else {
                    preview.src = '#';
                    preview.style.display = 'none';
                }
            }
        </script>

    </th:block>
</body>

</html>