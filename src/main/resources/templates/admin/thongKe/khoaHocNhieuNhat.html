<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>
  <div id="main" th:fragment="content">
    <header class="mb-3">
      <a href="#" class="burger-btn d-block d-xl-none">
        <i class="bi bi-justify fs-3"></i>
      </a>
    </header>
    <div class="page-heading">
      <div class="page-title">
        <div class="row">
          <div class="col-12 col-md-6 order-md-1 order-last">
            <h3>Danh sách các khóa học được học nhiều nhất</h3>
          </div>
          <div class="col-12 col-md-6 order-md-2 order-first">
            <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a th:href="@{/admin/dashboard}">Tổng quan</a></li>
                <li class="breadcrumb-item active" aria-current="page">Danh sách các khóa học được học nhiều nhất</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
      <section class="section">
        <div class="card">
          <div class="card-body">
            <table class="table table-striped" id="table1">
              <thead>
                <tr>
                  <th>STT</th>
                  <th>Tên khóa học</th>
                  <th>Số học viên tham gia</th>
                  <th>Tỉ lệ hoàn thành (%)</th>
                  <th>Giảng viên phụ trách</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="course, stat : ${topCourses}">
                  <td th:text="${stat.index + 1}">1</td>
                  <td th:text="${course['courseTitle']}">Tên khóa học</td>
                  <td th:text="${course['studentCount']}">0</td>
                  <td th:text="${#numbers.formatDecimal((course.completionRate ?: 0) * 100, 0, 0)} + '%'"></td>
                  <td th:text="${course['instructorName']}">Tên giảng viên</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Top 5 khóa học theo số lượng học sinh</h4>
          </div>
          <div class="card-body">
            <canvas id="bar" width="710" height="355"
              style="display: block; box-sizing: border-box; height: 355px; width: 710px"></canvas>
          </div>
        </div>
      </section>
    </div>
  </div>
  <th:block th:fragment="scripts">
    <script>
      // Simple Datatable
      let dataTable = new simpleDatatables.DataTable(table1, {
        perPage: 5,
        perPageSelect: false, // Tắt dropdown chọn số entries
      });
    </script>
    <script th:inline="javascript">
      let labels = /*[[${courseLabels}]]*/[];
      let data = /*[[${courseData}]]*/[];
      // console.log("courseLabels:", courseLabels);
      // console.log("courseData:", courseData);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/admin-assets/js/pages/ui-chartjs.js"></script>
  </th:block>
</body>

</html>